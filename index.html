<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SVG Tangents and Curves</title>
    <style>
        /* Style for displaying the SVG code as text */
        #svg-code-container {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            background-color: #f5f5f5;
            font-family: monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
    </style>
</head>
<body>



















    <!-- paste different svg here -->



    
    <?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 293.68 207.71">
  <defs>
    <style>
      .cls-1 {
        fill: #ed1c24;
        fill-rule: evenodd;
      }
    </style>
  </defs>
  <!-- Generator: Adobe Illustrator 28.7.1, SVG Export Plug-In . SVG Version: 1.2.0 Build 142)  -->
  <g>
    <g id="Layer_1">
      <g id="Layer_1-2" data-name="Layer_1">
        <path class="cls-1" d="M61.93,123.36s13.17-26.79,24.72-36.72,19.62-15.05,57.36-13.92c37.74,1.13,85.68,4.56,85.68,4.56,0,0,4.7.71,1.92,5.04-2.78,4.33-12.55,20.57-25.44,25.2-12.89,4.63-100.8,22.8-100.8,22.8,0,0-31.25,7.73-39.12,3.6-6.46-3.39-5.23-8.67-4.32-10.56Z"/>
      </g>
    </g>
  </g>
</svg>

















    <!-- Container to display the SVG code -->
    <div id="svg-code-container"></div>

    <script>














        //can change these

        let offsetMM = 5; // blade off set in mm
        let arcsNum = 3000; // Number of tangents

        let tangentStroke = 0.05; // Set 0 to remove tangents
        let tangentColor = 'green'; //set color for tangents

        let newCurveStroke = 0.1; 
        let newCurveColor = 'blue';






















        // Function to convert millimeters to pixels (1mm â‰ˆ 3.78px)
        function mmToPx(mm) {
            const mmToPxRatio = 96 / 25.4; // Conversion ratio (96 PPI / 25.4mm per inch)
            return mm * mmToPxRatio;
        }

        // Convert offset from mm to px
        let offset = mmToPx(offsetMM);

        // Function to get points and tangents on the path
        function getTangentPoints(svgPath, divisions) {
            const pathLength = svgPath.getTotalLength(); // Get total length of the path
            const points = [];
            const tangents = [];

            for (let i = 0; i <= divisions; i++) {
                const distance = (pathLength / divisions) * i; // Divide path into equal segments
                const point = svgPath.getPointAtLength(distance); // Get the point on the path
                const nextPoint = svgPath.getPointAtLength(distance + 0.01); // Slightly ahead to calculate tangent

                // Tangent is the difference between two consecutive points
                const tangent = {
                    x: nextPoint.x - point.x,
                    y: nextPoint.y - point.y,
                };

                points.push(point); // Save point
                tangents.push(tangent); // Save tangent
            }

            return { points, tangents };
        }

        // Function to normalize a vector and scale it to a fixed length (x px)
        function normalizeAndScale(tangent, length) {
            const magnitude = Math.sqrt(
                tangent.x * tangent.x + tangent.y * tangent.y
            ); // Calculate magnitude
            return {
                x: (tangent.x / magnitude) * length, // Scale the x-component
                y: (tangent.y / magnitude) * length, // Scale the y-component
            };
        }

        // Ensure the tangents always point in the same direction
        function adjustTangentDirection(currentTangent, previousTangent) {
            // Dot product to determine if the current tangent is pointing in the opposite direction
            const dotProduct =
                currentTangent.x * previousTangent.x +
                currentTangent.y * previousTangent.y;
            if (dotProduct < 0) {
                // Reverse the current tangent's direction if it's opposite
                return {
                    x: -currentTangent.x,
                    y: -currentTangent.y,
                };
            }
            return currentTangent;
        }

        // Function to draw tangent lines
        function drawTangentLines(svg, points, tangents, lengthPX = 100) {
            let previousTangent = tangents[0]; // Start with the first tangent as a reference

            points.forEach((point, index) => {
                let tangent = tangents[index];

                // Adjust tangent direction based on the previous one to ensure consistency
                tangent = adjustTangentDirection(tangent, previousTangent);

                // Normalize and scale to fixed length
                tangent = normalizeAndScale(tangent, lengthPX);

                previousTangent = tangent; // Update the previous tangent for the next iteration

                // Calculate the end point of the tangent
                const tangentEnd = {
                    x: point.x + tangent.x,
                    y: point.y + tangent.y,
                };

                // Create a line for each tangent
                const line = document.createElementNS(
                    "http://www.w3.org/2000/svg",
                    "line"
                );
                line.setAttribute("x1", point.x);
                line.setAttribute("y1", point.y);
                line.setAttribute("x2", tangentEnd.x);
                line.setAttribute("y2", tangentEnd.y);
                line.setAttribute("stroke", tangentColor);
                line.setAttribute("stroke-width", tangentStroke);

                svg.appendChild(line); // Add the tangent line to the SVG
            });
        }

        // Function to draw a straight curve connecting the end points of the tangents
        function drawStraightLineCurve(
            svg,
            points,
            tangents,
            lengthPX = 100
        ) {
            let previousTangent = tangents[0]; // Start with the first tangent as a reference
            let pathData = "M"; // Initialize path data with the 'move to' command
            const tangentEnds = [];

            points.forEach((point, index) => {
                let tangent = tangents[index];

                // Adjust tangent direction based on the previous one to ensure consistency
                tangent = adjustTangentDirection(tangent, previousTangent);

                // Normalize and scale to fixed length
                tangent = normalizeAndScale(tangent, lengthPX);

                previousTangent = tangent; // Update the previous tangent for the next iteration

                // Calculate the end point of the tangent
                const tangentEnd = {
                    x: point.x + tangent.x,
                    y: point.y + tangent.y,
                };

                tangentEnds.push(tangentEnd); // Store the end point
            });

            // Create the path for the straight line connecting tangent ends
            pathData += `${tangentEnds[0].x},${tangentEnds[0].y}`; // Start the path at the first tangent end
            for (let i = 1; i < tangentEnds.length; i++) {
                pathData += ` L${tangentEnds[i].x},${tangentEnds[i].y}`; // Draw a line to each subsequent tangent end
            }

            // Create the new path element
            const newPath = document.createElementNS(
                "http://www.w3.org/2000/svg",
                "path"
            );
            newPath.setAttribute("d", pathData);
            newPath.setAttribute("stroke", newCurveColor);
            newPath.setAttribute("fill", "none");
            newPath.setAttribute("stroke-width", newCurveStroke);

            svg.appendChild(newPath); // Add the new path to the SVG
        }

        // Function to display the SVG code as text
        function displaySVGCode() {
            const svgElement = document.querySelector('svg');
            const svgCode = new XMLSerializer().serializeToString(svgElement);
            document.getElementById('svg-code-container').textContent = svgCode;
        }

        // Main execution
        const svgCanvas = document.getElementsByTagName("svg")[0]; // Select the first SVG element
        const path = document.getElementsByTagName("path")[0]; // Select the first path element

        // Ensure the path is properly selected before proceeding
        if (path) {
            const { points, tangents } = getTangentPoints(path, arcsNum);

            // Draw tangent lines (in green)
            drawTangentLines(svgCanvas, points, tangents, offset);

            // Draw a straight line curve connecting the tangent ends (in blue)
            drawStraightLineCurve(svgCanvas, points, tangents, offset);
        } else {
            console.error("No path element found in the SVG.");
        }

        // Display the SVG code
        displaySVGCode();
    </script>
</body>
</html>
